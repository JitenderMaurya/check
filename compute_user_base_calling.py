import requests
import pdb
import json



formula= {"Step 1: Identify the size of the population in scope":["Indian_Subcontinent_Internet_Users = India_Total_Population * India_Internet_Penetration / 100","Indian_Subcontinent_High_Income_AI_Adopters = Indian_Subcontinent_Internet_Users * India_High_Income_Share / 100 * High_Income_AI_Adoption_Rate / 100","Indian_Subcontinent_Mid_Income_AI_Adopters = Indian_Subcontinent_Internet_Users * India_Mid_Income_Share / 100 * Mid_Income_AI_Adoption_Rate / 100","Indian_Subcontinent_Low_Income_AI_Adopters = Indian_Subcontinent_Internet_Users * India_Low_Income_Share / 100 * Low_Income_AI_Adoption_Rate / 100","Middle_East_Africa_Internet_Users = UAE_Total_Population * UAE_Internet_Penetration / 100","Middle_East_Africa_High_Income_AI_Adopters = Middle_East_Africa_Internet_Users * UAE_High_Income_Share / 100 * High_Income_AI_Adoption_Rate / 100","Middle_East_Africa_Mid_Income_AI_Adopters = Middle_East_Africa_Internet_Users * UAE_Mid_Income_Share / 100 * Mid_Income_AI_Adoption_Rate / 100","Middle_East_Africa_Low_Income_AI_Adopters = Middle_East_Africa_Internet_Users * UAE_Low_Income_Share / 100 * Low_Income_AI_Adoption_Rate / 100","UK_Europe_Internet_Users = UK_Total_Population * UK_Internet_Penetration / 100","UK_Europe_High_Income_AI_Adopters = UK_Europe_Internet_Users * UK_High_Income_Share / 100 * High_Income_AI_Adoption_Rate / 100","UK_Europe_Mid_Income_AI_Adopters = UK_Europe_Internet_Users * UK_Mid_Income_Share / 100 * Mid_Income_AI_Adoption_Rate / 100","UK_Europe_Low_Income_AI_Adopters = UK_Europe_Internet_Users * UK_Low_Income_Share / 100 * Low_Income_AI_Adoption_Rate / 100","Indian_Subcontinent_Small_Enterprise_Seats = India_Enterprise_Count * Small_Enterprise_Share / 100 * Small_Enterprise_AI_Adoption_Rate / 100 * Average_Seats_Per_Small_Enterprise","Indian_Subcontinent_Medium_Enterprise_Seats = India_Enterprise_Count * Medium_Enterprise_Share / 100 * Medium_Enterprise_AI_Adoption_Rate / 100 * Average_Seats_Per_Medium_Enterprise","Indian_Subcontinent_Large_Enterprise_Seats = India_Enterprise_Count * Large_Enterprise_Share / 100 * Large_Enterprise_AI_Adoption_Rate / 100 * Average_Seats_Per_Large_Enterprise","Middle_East_Africa_Small_Enterprise_Seats = UAE_Enterprise_Count * Small_Enterprise_Share / 100 * Small_Enterprise_AI_Adoption_Rate / 100 * Average_Seats_Per_Small_Enterprise","Middle_East_Africa_Medium_Enterprise_Seats = UAE_Enterprise_Count * Medium_Enterprise_Share / 100 * Medium_Enterprise_AI_Adoption_Rate / 100 * Average_Seats_Per_Medium_Enterprise","Middle_East_Africa_Large_Enterprise_Seats = UAE_Enterprise_Count * Large_Enterprise_Share / 100 * Large_Enterprise_AI_Adoption_Rate / 100 * Average_Seats_Per_Large_Enterprise","UK_Europe_Small_Enterprise_Seats = UK_Enterprise_Count * Small_Enterprise_Share / 100 * Small_Enterprise_AI_Adoption_Rate / 100 * Average_Seats_Per_Small_Enterprise","UK_Europe_Medium_Enterprise_Seats = UK_Enterprise_Count * Medium_Enterprise_Share / 100 * Medium_Enterprise_AI_Adoption_Rate / 100 * Average_Seats_Per_Medium_Enterprise","UK_Europe_Large_Enterprise_Seats = UK_Enterprise_Count * Large_Enterprise_Share / 100 * Large_Enterprise_AI_Adoption_Rate / 100 * Average_Seats_Per_Large_Enterprise"],"Step 2: Identify the growth rate of the segment":["Total_Indian_Subcontinent_High_Income_AI_Adopters = Indian_Subcontinent_High_Income_AI_Adopters * (1 + India_Population_Growth_Rate / 100)","Total_Indian_Subcontinent_Mid_Income_AI_Adopters = Indian_Subcontinent_Mid_Income_AI_Adopters * (1 + India_Population_Growth_Rate / 100)","Total_Indian_Subcontinent_Low_Income_AI_Adopters = Indian_Subcontinent_Low_Income_AI_Adopters * (1 + India_Population_Growth_Rate / 100)","Total_Middle_East_Africa_High_Income_AI_Adopters = Middle_East_Africa_High_Income_AI_Adopters * (1 + UAE_Population_Growth_Rate / 100)","Total_Middle_East_Africa_Mid_Income_AI_Adopters = Middle_East_Africa_Mid_Income_AI_Adopters * (1 + UAE_Population_Growth_Rate / 100)","Total_Middle_East_Africa_Low_Income_AI_Adopters = Middle_East_Africa_Low_Income_AI_Adopters * (1 + UAE_Population_Growth_Rate / 100)","Total_UK_Europe_High_Income_AI_Adopters = UK_Europe_High_Income_AI_Adopters * (1 + UK_Population_Growth_Rate / 100)","Total_UK_Europe_Mid_Income_AI_Adopters = UK_Europe_Mid_Income_AI_Adopters * (1 + UK_Population_Growth_Rate / 100)","Total_UK_Europe_Low_Income_AI_Adopters = UK_Europe_Low_Income_AI_Adopters * (1 + UK_Population_Growth_Rate / 100)","Total_Indian_Subcontinent_Small_Enterprise_Seats = Indian_Subcontinent_Small_Enterprise_Seats * (1 + India_Enterprise_Growth_Rate / 100)","Total_Indian_Subcontinent_Medium_Enterprise_Seats = Indian_Subcontinent_Medium_Enterprise_Seats * (1 + India_Enterprise_Growth_Rate / 100)","Total_Indian_Subcontinent_Large_Enterprise_Seats = Indian_Subcontinent_Large_Enterprise_Seats * (1 + India_Enterprise_Growth_Rate / 100)","Total_Middle_East_Africa_Small_Enterprise_Seats = Middle_East_Africa_Small_Enterprise_Seats * (1 + UAE_Enterprise_Growth_Rate / 100)","Total_Middle_East_Africa_Medium_Enterprise_Seats = Middle_East_Africa_Medium_Enterprise_Seats * (1 + UAE_Enterprise_Growth_Rate / 100)","Total_Middle_East_Africa_Large_Enterprise_Seats = Middle_East_Africa_Large_Enterprise_Seats * (1 + UAE_Enterprise_Growth_Rate / 100)","Total_UK_Europe_Small_Enterprise_Seats = UK_Europe_Small_Enterprise_Seats * (1 + UK_Enterprise_Growth_Rate / 100)","Total_UK_Europe_Medium_Enterprise_Seats = UK_Europe_Medium_Enterprise_Seats * (1 + UK_Enterprise_Growth_Rate / 100)","Total_UK_Europe_Large_Enterprise_Seats = UK_Europe_Large_Enterprise_Seats * (1 + UK_Enterprise_Growth_Rate / 100)"],"Step 3: Company market share":["Indian_Subcontinent_High_Income_Addressable_Market = Total_Indian_Subcontinent_High_Income_AI_Adopters * Indian_Subcontinent_High_Income_Market_Share / 100","Indian_Subcontinent_Mid_Income_Addressable_Market = Total_Indian_Subcontinent_Mid_Income_AI_Adopters * Indian_Subcontinent_Mid_Income_Market_Share / 100","Indian_Subcontinent_Low_Income_Addressable_Market = Total_Indian_Subcontinent_Low_Income_AI_Adopters * Indian_Subcontinent_Low_Income_Market_Share / 100","Middle_East_Africa_High_Income_Addressable_Market = Total_Middle_East_Africa_High_Income_AI_Adopters * Middle_East_Africa_High_Income_Market_Share / 100","Middle_East_Africa_Mid_Income_Addressable_Market = Total_Middle_East_Africa_Mid_Income_AI_Adopters * Middle_East_Africa_Mid_Income_Market_Share / 100","Middle_East_Africa_Low_Income_Addressable_Market = Total_Middle_East_Africa_Low_Income_AI_Adopters * Middle_East_Africa_Low_Income_Market_Share / 100","UK_Europe_High_Income_Addressable_Market = Total_UK_Europe_High_Income_AI_Adopters * UK_Europe_High_Income_Market_Share / 100","UK_Europe_Mid_Income_Addressable_Market = Total_UK_Europe_Mid_Income_AI_Adopters * UK_Europe_Mid_Income_Market_Share / 100","UK_Europe_Low_Income_Addressable_Market = Total_UK_Europe_Low_Income_AI_Adopters * UK_Europe_Low_Income_Market_Share / 100","Indian_Subcontinent_Small_Enterprise_Addressable_Seats = Total_Indian_Subcontinent_Small_Enterprise_Seats * Indian_Subcontinent_Small_Enterprise_Market_Share / 100","Indian_Subcontinent_Medium_Enterprise_Addressable_Seats = Total_Indian_Subcontinent_Medium_Enterprise_Seats * Indian_Subcontinent_Medium_Enterprise_Market_Share / 100","Indian_Subcontinent_Large_Enterprise_Addressable_Seats = Total_Indian_Subcontinent_Large_Enterprise_Seats * Indian_Subcontinent_Large_Enterprise_Market_Share / 100","Middle_East_Africa_Small_Enterprise_Addressable_Seats = Total_Middle_East_Africa_Small_Enterprise_Seats * Middle_East_Africa_Small_Enterprise_Market_Share / 100","Middle_East_Africa_Medium_Enterprise_Addressable_Seats = Total_Middle_East_Africa_Medium_Enterprise_Seats * Middle_East_Africa_Medium_Enterprise_Market_Share / 100","Middle_East_Africa_Large_Enterprise_Addressable_Seats = Total_Middle_East_Africa_Large_Enterprise_Seats * Middle_East_Africa_Large_Enterprise_Market_Share / 100","UK_Europe_Small_Enterprise_Addressable_Seats = Total_UK_Europe_Small_Enterprise_Seats * UK_Europe_Small_Enterprise_Market_Share / 100","UK_Europe_Medium_Enterprise_Addressable_Seats = Total_UK_Europe_Medium_Enterprise_Seats * UK_Europe_Medium_Enterprise_Market_Share / 100","UK_Europe_Large_Enterprise_Addressable_Seats = Total_UK_Europe_Large_Enterprise_Seats * UK_Europe_Large_Enterprise_Market_Share / 100"],"Step 4: Factor gains and losses of customers from and to competitors":["Indian_Subcontinent_High_Income_Churn = Indian_Subcontinent_High_Income_Addressable_Market * Indian_Subcontinent_High_Income_Churn_Rate / 100","Indian_Subcontinent_Mid_Income_Churn = Indian_Subcontinent_Mid_Income_Addressable_Market * Indian_Subcontinent_Mid_Income_Churn_Rate / 100","Indian_Subcontinent_Low_Income_Churn = Indian_Subcontinent_Low_Income_Addressable_Market * Indian_Subcontinent_Low_Income_Churn_Rate / 100","Middle_East_Africa_High_Income_Churn = Middle_East_Africa_High_Income_Addressable_Market * Middle_East_Africa_High_Income_Churn_Rate / 100","Middle_East_Africa_Mid_Income_Churn = Middle_East_Africa_Mid_Income_Addressable_Market * Middle_East_Africa_Mid_Income_Churn_Rate / 100","Middle_East_Africa_Low_Income_Churn = Middle_East_Africa_Low_Income_Addressable_Market * Middle_East_Africa_Low_Income_Churn_Rate / 100","UK_Europe_High_Income_Churn = UK_Europe_High_Income_Addressable_Market * UK_Europe_High_Income_Churn_Rate / 100","UK_Europe_Mid_Income_Churn = UK_Europe_Mid_Income_Addressable_Market * UK_Europe_Mid_Income_Churn_Rate / 100","UK_Europe_Low_Income_Churn = UK_Europe_Low_Income_Addressable_Market * UK_Europe_Low_Income_Churn_Rate / 100","Indian_Subcontinent_Small_Enterprise_Churn = Indian_Subcontinent_Small_Enterprise_Addressable_Seats * Indian_Subcontinent_Small_Enterprise_Churn_Rate / 100","Indian_Subcontinent_Medium_Enterprise_Churn = Indian_Subcontinent_Medium_Enterprise_Addressable_Seats * Indian_Subcontinent_Medium_Enterprise_Churn_Rate / 100","Indian_Subcontinent_Large_Enterprise_Churn = Indian_Subcontinent_Large_Enterprise_Addressable_Seats * Indian_Subcontinent_Large_Enterprise_Churn_Rate / 100","Middle_East_Africa_Small_Enterprise_Churn = Middle_East_Africa_Small_Enterprise_Addressable_Seats * Middle_East_Africa_Small_Enterprise_Churn_Rate / 100","Middle_East_Africa_Medium_Enterprise_Churn = Middle_East_Africa_Medium_Enterprise_Addressable_Seats * Middle_East_Africa_Medium_Enterprise_Churn_Rate / 100","Middle_East_Africa_Large_Enterprise_Churn = Middle_East_Africa_Large_Enterprise_Addressable_Seats * Middle_East_Africa_Large_Enterprise_Churn_Rate / 100","UK_Europe_Small_Enterprise_Churn = UK_Europe_Small_Enterprise_Addressable_Seats * UK_Europe_Small_Enterprise_Churn_Rate / 100","UK_Europe_Medium_Enterprise_Churn = UK_Europe_Medium_Enterprise_Addressable_Seats * UK_Europe_Medium_Enterprise_Churn_Rate / 100","UK_Europe_Large_Enterprise_Churn = UK_Europe_Large_Enterprise_Addressable_Seats * UK_Europe_Large_Enterprise_Churn_Rate / 100"],"Step 5: Total user base":["Indian_Subcontinent_High_Income_Users = Indian_Subcontinent_High_Income_Addressable_Market - Indian_Subcontinent_High_Income_Churn","Indian_Subcontinent_Mid_Income_Users = Indian_Subcontinent_Mid_Income_Addressable_Market - Indian_Subcontinent_Mid_Income_Churn","Indian_Subcontinent_Low_Income_Users = Indian_Subcontinent_Low_Income_Addressable_Market - Indian_Subcontinent_Low_Income_Churn","Middle_East_Africa_High_Income_Users = Middle_East_Africa_High_Income_Addressable_Market - Middle_East_Africa_High_Income_Churn","Middle_East_Africa_Mid_Income_Users = Middle_East_Africa_Mid_Income_Addressable_Market - Middle_East_Africa_Mid_Income_Churn","Middle_East_Africa_Low_Income_Users = Middle_East_Africa_Low_Income_Addressable_Market - Middle_East_Africa_Low_Income_Churn","UK_Europe_High_Income_Users = UK_Europe_High_Income_Addressable_Market - UK_Europe_High_Income_Churn","UK_Europe_Mid_Income_Users = UK_Europe_Mid_Income_Addressable_Market - UK_Europe_Mid_Income_Churn","UK_Europe_Low_Income_Users = UK_Europe_Low_Income_Addressable_Market - UK_Europe_Low_Income_Churn","Indian_Subcontinent_Small_Enterprise_Users = Indian_Subcontinent_Small_Enterprise_Addressable_Seats - Indian_Subcontinent_Small_Enterprise_Churn","Indian_Subcontinent_Medium_Enterprise_Users = Indian_Subcontinent_Medium_Enterprise_Addressable_Seats - Indian_Subcontinent_Medium_Enterprise_Churn","Indian_Subcontinent_Large_Enterprise_Users = Indian_Subcontinent_Large_Enterprise_Addressable_Seats - Indian_Subcontinent_Large_Enterprise_Churn","Middle_East_Africa_Small_Enterprise_Users = Middle_East_Africa_Small_Enterprise_Addressable_Seats - Middle_East_Africa_Small_Enterprise_Churn","Middle_East_Africa_Medium_Enterprise_Users = Middle_East_Africa_Medium_Enterprise_Addressable_Seats - Middle_East_Africa_Medium_Enterprise_Churn","Middle_East_Africa_Large_Enterprise_Users = Middle_East_Africa_Large_Enterprise_Addressable_Seats - Middle_East_Africa_Large_Enterprise_Churn","UK_Europe_Small_Enterprise_Users = UK_Europe_Small_Enterprise_Addressable_Seats - UK_Europe_Small_Enterprise_Churn","UK_Europe_Medium_Enterprise_Users = UK_Europe_Medium_Enterprise_Addressable_Seats - UK_Europe_Medium_Enterprise_Churn","UK_Europe_Large_Enterprise_Users = UK_Europe_Large_Enterprise_Addressable_Seats - UK_Europe_Large_Enterprise_Churn","Total_User_Base = Indian_Subcontinent_High_Income_Users + Indian_Subcontinent_Mid_Income_Users + Indian_Subcontinent_Low_Income_Users + Middle_East_Africa_High_Income_Users + Middle_East_Africa_Mid_Income_Users + Middle_East_Africa_Low_Income_Users + UK_Europe_High_Income_Users + UK_Europe_Mid_Income_Users + UK_Europe_Low_Income_Users + Indian_Subcontinent_Small_Enterprise_Users + Indian_Subcontinent_Medium_Enterprise_Users + Indian_Subcontinent_Large_Enterprise_Users + Middle_East_Africa_Small_Enterprise_Users + Middle_East_Africa_Medium_Enterprise_Users + Middle_East_Africa_Large_Enterprise_Users + UK_Europe_Small_Enterprise_Users + UK_Europe_Medium_Enterprise_Users + UK_Europe_Large_Enterprise_Users"]}

# SOlve user base equations..............................
description_payload = {
    "assumption_values":{'2025': ['', 5, 12, 5825400, 99.5, 14, 18, 410800, 16, 31, 19, 3, 48, 66625000, 520, 10280000, 85, 24, 1432200000, 96, 46, 52, 40, 50, 7, 68407000, 52, 30, 11, 52, 36, '', 3.1, 2.4, 3.0, 2.8, 2.3, 2.6, '', 7, 5, 25, 4, 12, 3, 2, 10, 10, 6, 18, 14, 7, 12, 10, 5, 20, 14, '', 13, 10, 9, 16, 6, 18, 10, 12, 7, 5, 8, 8, 8, 12, 14, 6, 10, 7, ''], '2026': ['', 5, 12, 5967208, 99.8, 13, 22, 423124, 17, 32, 18, 3, 46, 68490500, 540, 10598680, 85, 29, 1469472000, 97, 47, 54, 40, 50, 9, 69983610, 60, 36, 14, 58, 37, '', 3.4, 2.6, 3.3, 3.1, 2.5, 2.9, '', 8, 6, 28, 5, 14, 4, 3, 12, 12, 7, 21, 16, 8, 14, 12, 6, 22, 16, '', 11, 8, 7, 14, 5, 16, 8, 10, 6, 4, 6, 6, 6, 10, 12, 4, 8, 6, ''], '2027': ['', 5, 12, 6265766, 99.9, 11, 32, 447894, 19, 34, 16, 3, 42, 72142470, 580, 11224178, 85, 42, 1542926600, 98, 49, 58, 40, 50, 14, 73333000, 78, 48, 22, 72, 39, '', 4.2, 3.1, 4.0, 3.8, 3.0, 3.6, '', 11, 9, 35, 8, 19, 7, 6, 17, 17, 10, 28, 21, 11, 19, 17, 9, 27, 21, '', 8, 5, 4, 11, 3, 13, 5, 7, 4, 2, 3, 3, 3, 7, 9, 2, 5, 4, '']},
    "units":['', '#', '%', '#', '%', '%', '%', '#', '%', '%', '%', '%', '%', '#', '#', '#', '%', '%', '#', '%', '%', '#', '%', '%', '%', '#', '%', '%', '%', '%', '%', '', '%', '%', '%', '%', '%', '%', '', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', '%', ''],
    "currency":"USD",
    "formula":formula,
    "steps":['Step 1: Identify the size of the population in scope', 'Average_Seats_Per_Small_Enterprise', 'Medium_Enterprise_Share', 'UK_Enterprise_Count', 'UAE_Internet_Penetration', 'UAE_Low_Income_Share', 'Mid_Income_AI_Adoption_Rate', 'UAE_Enterprise_Count', 'India_High_Income_Share', 'UK_High_Income_Share', 'UK_Low_Income_Share', 'Large_Enterprise_Share', 'India_Low_Income_Share', 'India_Enterprise_Count', 'Average_Seats_Per_Large_Enterprise', 'UAE_Total_Population', 'Small_Enterprise_Share', 'Medium_Enterprise_AI_Adoption_Rate', 'India_Total_Population', 'UK_Internet_Penetration', 'UAE_Mid_Income_Share', 'Average_Seats_Per_Medium_Enterprise', 'UAE_High_Income_Share', 'UK_Mid_Income_Share', 'Low_Income_AI_Adoption_Rate', 'UK_Total_Population', 'Large_Enterprise_AI_Adoption_Rate', 'High_Income_AI_Adoption_Rate', 'Small_Enterprise_AI_Adoption_Rate', 'India_Internet_Penetration', 'India_Mid_Income_Share', 'Step 2: Identify the growth rate of the segment', 'UAE_Population_Growth_Rate', 'UK_Enterprise_Growth_Rate', 'UAE_Enterprise_Growth_Rate', 'India_Enterprise_Growth_Rate', 'UK_Population_Growth_Rate', 'India_Population_Growth_Rate', 'Step 3: Company market share', 'Middle_East_Africa_Small_Enterprise_Market_Share', 'Indian_Subcontinent_Medium_Enterprise_Market_Share', 'UK_Europe_Large_Enterprise_Market_Share', 'Indian_Subcontinent_Mid_Income_Market_Share', 'Middle_East_Africa_Medium_Enterprise_Market_Share', 'Indian_Subcontinent_Small_Enterprise_Market_Share', 'Indian_Subcontinent_Low_Income_Market_Share', 'Middle_East_Africa_Mid_Income_Market_Share', 'Indian_Subcontinent_Large_Enterprise_Market_Share', 'Indian_Subcontinent_High_Income_Market_Share', 'UK_Europe_High_Income_Market_Share', 'Middle_East_Africa_High_Income_Market_Share', 'UK_Europe_Low_Income_Market_Share', 'UK_Europe_Mid_Income_Market_Share', 'UK_Europe_Small_Enterprise_Market_Share', 'Middle_East_Africa_Low_Income_Market_Share', 'Middle_East_Africa_Large_Enterprise_Market_Share', 'UK_Europe_Medium_Enterprise_Market_Share', 'Step 4: Factor gains and losses of customers from and to competitors', 'Indian_Subcontinent_High_Income_Churn_Rate', 'UK_Europe_Low_Income_Churn_Rate', 'UK_Europe_Medium_Enterprise_Churn_Rate', 'Middle_East_Africa_High_Income_Churn_Rate', 'Middle_East_Africa_Large_Enterprise_Churn_Rate', 'UK_Europe_High_Income_Churn_Rate', 'Indian_Subcontinent_Mid_Income_Churn_Rate', 'Middle_East_Africa_Mid_Income_Churn_Rate', 'Indian_Subcontinent_Medium_Enterprise_Churn_Rate', 'Indian_Subcontinent_Large_Enterprise_Churn_Rate', 'Middle_East_Africa_Low_Income_Churn_Rate', 'Middle_East_Africa_Medium_Enterprise_Churn_Rate', 'Indian_Subcontinent_Small_Enterprise_Churn_Rate', 'UK_Europe_Small_Enterprise_Churn_Rate', 'UK_Europe_Mid_Income_Churn_Rate', 'Indian_Subcontinent_Low_Income_Churn_Rate', 'Middle_East_Africa_Small_Enterprise_Churn_Rate', 'UK_Europe_Large_Enterprise_Churn_Rate', 'Step 5: Total user base'],
}

user_base_compute = requests.post(
    f"{BASE_URL}/compute_user_base",
    json=description_payload,
)

print("\nResponse from /user_base_compute.....................")
print(user_base_compute.text)

